import{d as w,s as D,o as I,v as x,w as S,c as r,e as i,f as d,B as _,J as h,i as v,F as y,m as g,t as b,u as $,n as A,z as C}from"./index-Bx7n4dr3.js";import{u as U}from"./userStore-s7XRrkk9.js";import{t as f}from"./taiwanCities-y_p8gqPp.js";const B=d("label",{for:"birthdate",class:"form-label"},"生日",-1),F={class:"flex gap-2"},L=["value"],M=["value"],R=["value"],H=w({__name:"DateSelect",setup(z){const k=U(),{birthdate:t,userInfo:u}=D(k);I(()=>{var e;console.log("birthdate",t.value),console.log("userInfo",u.value);let a=(((e=u.value)==null?void 0:e.birthday)??"").match(/^(\d{4})-(\d{2})-(\d{2})/);a&&(t.value.year=parseInt(a[1]),t.value.month=parseInt(a[2]),t.value.day=parseInt(a[3]),console.log(t.value))});const n=x(()=>{const l=t.value.year,a=t.value.month;return a===2?l%400===0||l%100!==0&&l%4===0?29:28:[4,6,9,11].includes(a)?30:31}),m=()=>{const l=n.value;t.value.day>l&&(t.value.day=l)};return S(()=>t.value.year,m),S(()=>t.value.month,m),(l,a)=>(r(),i("div",null,[B,d("div",F,[_(d("select",{"onUpdate:modelValue":a[0]||(a[0]=e=>v(t).year=e),class:"form-input",onChange:m},[(r(!0),i(y,null,g(Array.from({length:new Date().getFullYear()-1899},(e,p)=>p+1900).reverse(),e=>(r(),i("option",{key:e,value:e},b(e)+" 年",9,L))),128))],544),[[h,v(t).year]]),_(d("select",{"onUpdate:modelValue":a[1]||(a[1]=e=>v(t).month=e),class:"form-input",onChange:m},[(r(!0),i(y,null,g(Array.from({length:12},(e,p)=>p+1),e=>(r(),i("option",{key:e,value:e},b(e)+" 月",9,M))),128))],544),[[h,v(t).month]]),_(d("select",{"onUpdate:modelValue":a[2]||(a[2]=e=>v(t).day=e),class:"form-input"},[(r(!0),i(y,null,g(n.value,e=>(r(),i("option",{key:e,value:e},b(e)+" 日",9,R))),128))],512),[[h,v(t).day]])])]))}}),Y={class:"flex flex-col space-y-1"},Z={class:""},E={class:"flex space-x-2"},J=["value"],P=["value"],K=w({__name:"CitySelect",setup(z){const k=$(),t=U(),{selectedCity:u,selectedDistrict:n,detailedAddress:m,selectedZip:l,userInfo:a}=D(t),e=x(()=>f.map(c=>c.name)),p=x(()=>{const c=f.find(s=>s.name===u.value);return c?c.districts:[]}),N=()=>{n.value=p.value.length>0?p.value[0].name??"":""};S(n,()=>{console.log(l.value,u.value,n.value);const c=f.find(s=>s.name===u.value);if(c){const s=c.districts.find(o=>o.name===n.value);s?l.value=Number(s.zip):l.value=NaN}else l.value=NaN;console.log(l.value)});const V=()=>{if(k.fullPath==="/user"){console.log(a.value),l.value=a.value.address.zipcode,console.log(l.value);for(const c of f){const s=c.districts.find(o=>o.zip===l.value.toString());if(s){console.log(s),u.value=c.name,n.value=s.name;break}}m.value=a.value.address.detail.replace(u.value,""),m.value=m.value.replace(n.value,"")}else console.log(f[0]),u.value=f[0].name,n.value=f[0].districts[0].name};return I(()=>{V()}),(c,s)=>(r(),i("div",Y,[d("label",{for:"district",class:A(["form-label",v(k).name==="booking"?"text-neutral":"text-white"])},"地區",2),d("div",Z,[d("div",E,[_(d("select",{"onUpdate:modelValue":s[0]||(s[0]=o=>C(u)?u.value=o:null),class:"form-input block w-full mt-1",onChange:N},[(r(!0),i(y,null,g(e.value,o=>(r(),i("option",{key:o,value:o},b(o),9,J))),128))],544),[[h,v(u)]]),_(d("select",{"onUpdate:modelValue":s[1]||(s[1]=o=>C(n)?n.value=o:null),class:"form-input block w-full mt-1"},[(r(!0),i(y,null,g(p.value,o=>(r(),i("option",{key:o.zip,value:o.name},b(o.name),9,P))),128))],512),[[h,v(n)]])])])]))}});export{H as _,K as a};
