import{d as L,s as y,x as A,r as S,w as K,c as u,e as m,i as t,f as e,C as F,K as q,F as N,m as P,t as p,A as Z,D as Q,k as E,b as D,g as i,h as U,L as W,n as T,l as X,B as Y,u as ee,o as te,j as w,p as se,q as h}from"./index-0Nk66x3t.js";import{A as oe}from"./swal-bFiefLkh.js";import{_ as le}from"./RoomInfoMain.vue_vue_type_script_setup_true_lang-G-pbqW8K.js";import{u as B}from"./orderStore-RDvIab14.js";import{t as V}from"./taiwanCities-y_p8gqPp.js";import{u as G}from"./userStore-kUsPcSDg.js";import{_ as ae}from"./logo-primary-RekCkdNo.js";import{_ as ne}from"./_plugin-vue_export-helper-x3n3nnut.js";import{u as re}from"./roomStore-WGuFpXmP.js";import"./RoomInfoBasic.vue_vue_type_script_setup_true_lang-uvIDrCwu.js";import"./RoomInfoProvide.vue_vue_type_script_setup_true_lang-WjWRVNAn.js";const ie=e("label",{for:"userAddress"},"地址",-1),de={key:0,class:"grid grid-cols-2 gap-2"},ce={class:"relative"},ue=e("option",{value:"",selected:""},"請選擇縣市",-1),pe=["value"],me=e("div",{class:"absolute top-0 bottom-0 right-0 m-auto p-4"},[e("span",{class:"material-icons"},"keyboard_arrow_down")],-1),_e={class:"relative"},fe=e("option",{value:"",selected:""},"請選擇行政區",-1),ve=["value"],xe=e("div",{class:"absolute top-0 bottom-0 right-0 m-auto p-4"},[e("span",{class:"material-icons"},"keyboard_arrow_down")],-1),ge={class:"col-span-2"},he=L({__name:"AddressForm",setup(C,{expose:b}){const x=B(),{selectDistrict:l,addressDetail:n}=y(x),$=A(()=>V.map(d=>d.name)),k=A(()=>{const d=V.find(s=>s.name===r.value);return d?d.districts:[]}),r=S(""),a=S(),f=S(),g=()=>{l.value=(k.value.length>0,"")};K(l,()=>{const d=V.find(s=>s.name===r.value);if(d){const s=d.districts.find(o=>o.name===l.value);s?a.value=Number(s.zip):a.value=NaN}else a.value=NaN});const v=G(),{userInfo:c}=y(v);return b({getAddress:()=>{r.value=c.value.address.zipcode;for(const d of V){const s=d.districts.find(o=>o.zip===r.value.toString());if(s){r.value=d.name,l.value=s.zip,f.value=s.name;break}}n.value=c.value.address.detail.replace(r.value,""),n.value=n.value.replace(f.value,"")}}),(d,s)=>(u(),m(N,null,[ie,t(V)?(u(),m("div",de,[e("div",ce,[F(e("select",{name:"縣市",id:"","onUpdate:modelValue":s[0]||(s[0]=o=>r.value=o),class:"form-input",onChange:s[1]||(s[1]=o=>g())},[ue,(u(!0),m(N,null,P($.value,o=>(u(),m("option",{key:o,value:o},p(o),9,pe))),128))],544),[[q,r.value]]),me]),e("div",null,[e("div",_e,[F(e("select",{name:"行政區",id:"","onUpdate:modelValue":s[2]||(s[2]=o=>Z(l)?l.value=o:null),class:"form-input"},[fe,(u(!0),m(N,null,P(k.value,o=>(u(),m("option",{key:o.zip,value:o.zip},p(o.name),9,ve))),128))],512),[[q,t(l)]]),xe])]),e("div",ge,[F(e("input",{type:"text","onUpdate:modelValue":s[3]||(s[3]=o=>Z(n)?n.value=o:null),placeholder:"請輸入詳細地址",class:"p-4 rounded-2 w-full"},null,512),[[Q,t(n)]])])])):E("",!0)],64))}});var be={VITE_URL:"https://freyja-g4ow.onrender.com",BASE_URL:"/side-project-booking/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const $e={class:"flex mb-8 lg:mb-10"},ke=e("h2",{class:"text-5 lg:text-7 text-black"},"訂房人資訊",-1),ye={class:"flex flex-col gap-2"},we=e("label",{for:"userName"},"姓名",-1),Ve={class:"flex flex-col gap-2"},Ne=e("label",{for:"userPhone"},"手機號碼",-1),De={class:"flex flex-col gap-2"},Se=e("label",{for:"userEmail"},"電子信箱",-1),Ue=L({__name:"BookingForm",setup(C){const{VITE_URL:b}=be,x=B(),{userInfo:l}=y(x),n=r=>/^(09)[0-9]{8}$/.test(r)?!0:"請輸入正確電話號碼格式，例如 0987654321",$=S(),k=()=>{const r=`${b}/api/v1/user`;W.get(r).then(a=>{l.value=a.data.result,$.value.getAddress(),console.log("getUser 成功",l.value)}).catch(a=>{console.log("getUser 失敗",a)})};return(r,a)=>{const f=D("VField"),g=D("ErrorMessage"),_=D("VForm");return u(),m(N,null,[e("div",$e,[ke,e("button",{class:"btn-text ms-auto underline",onClick:a[0]||(a[0]=v=>k())},"套用會員資料")]),i(_,{class:"flex flex-col gap-4"},{default:U(({errors:v})=>[e("div",ye,[we,i(f,{type:"text",name:"姓名",class:T([{"border border-red-600":v.姓名},"p-4 rounded-2"]),rules:"required",modelValue:t(l).name,"onUpdate:modelValue":a[1]||(a[1]=c=>t(l).name=c),placeholder:"請輸入姓名"},null,8,["class","modelValue"]),i(g,{class:"text-red-600",name:"姓名"})]),e("div",Ve,[Ne,i(f,{type:"tel",name:"手機號碼",class:T([{"border border-red-600":v.手機號碼},"p-4 rounded-2"]),rules:n,modelValue:t(l).phone,"onUpdate:modelValue":a[2]||(a[2]=c=>t(l).phone=c),placeholder:"請輸入手機號碼"},null,8,["class","modelValue"]),i(g,{class:"text-red-600",name:"手機號碼"})]),e("div",De,[Se,i(f,{type:"email",name:"Email",class:T([{"border border-red-600":v.Email},"p-4 rounded-2"]),rules:"required|email",modelValue:t(l).email,"onUpdate:modelValue":a[3]||(a[3]=c=>t(l).email=c),placeholder:"請輸入有效電子信箱"},null,8,["class","modelValue"]),i(g,{class:"text-red-600",name:"Email"})]),i(he,{ref_key:"userAddressRef",ref:$},null,512)]),_:1})],64)}}}),Ce={},Re={class:"fixed top-0 left-0 w-full h-full bg-black/40 backdrop-blur-[10px]"},Fe=X('<div class="flex justify-center items-center h-full"><div class="w-[765px] h-[600px] bg-white rounded-[20px]"><div class="flex flex-col justify-center items-center h-full"><div class="flex gap-3 mb-[60px]"><span class="block w-[12px] h-[12px] rounded-full bg-neutral-100"></span><span class="block w-[12px] h-[12px] rounded-full bg-neutral-80"></span><span class="block w-[12px] h-[12px] rounded-full bg-neutral-60"></span></div><div class="w-[144px] mb-4"><img class="mb-[5.88px]" src="'+ae+'" alt="享樂飯店 Logo"></div><p class="text-6 font-bold">正在處理你的預定</p></div></div></div>',1),Te=[Fe];function Ae(C,b){return u(),m("div",Re,Te)}const Ee=ne(Ce,[["render",Ae]]),Le={key:0,class:"bg-primary-10"},Be={class:"container mx-auto px-4 xl:px-0 py-10 lg:py-30"},je={class:"flex flex-col lg:flex-row lg:justify-between gap-10 lg:gap-18"},ze={class:"basis-full lg:basis-7/12 flex flex-col gap-10"},Me=e("h2",{class:"text-5 lg:text-7 text-black mb-8 lg:mb-10"},"訂房資訊",-1),Ie={class:"flex flex-col gap-6 pb-10 lg:pb-[47px] border-b border-neutral-60"},Oe=e("h3",{class:"title-deco ps-4 text-4 mb-2"},"選擇房型",-1),qe={class:"flex items-center"},Pe=e("h3",{class:"title-deco ps-4 text-4 mb-2"},"訂房日期",-1),Ze={class:"mb-2"},Ke={class:"flex items-center"},Ge=e("h3",{class:"title-deco ps-4 text-4 mb-2"},"房客人數",-1),He={class:"pb-10 lg:pb-[47px] border-b border-neutral-60"},Je=e("h2",{class:"text-5 lg:text-7 text-black mb-8 lg:mb-10"},"房間資訊",-1),Qe={class:"flex flex-col gap-6"},We={class:"basis-full lg:basis-5/12"},Xe={class:"sticky top-[120px]"},Ye={class:"bg-white p-6 lg:p-10 rounded-[20px]"},et={class:"flex flex-col gap-6 lg:gap-10"},tt=["src","alt"],st={class:"flex flex-col gap-6"},ot=e("h2",{class:"text-5 lg:text-7"},"價格詳情",-1),lt={class:"flex flex-col gap-4"},at={class:"flex"},nt={class:"ms-auto"},rt=e("div",{class:"flex pb-4 border-b border-neutral-40"},[e("p",null,"住宿折扣")],-1),it={class:"flex font-bold"},dt=e("p",null,"總價",-1),ct={class:"ms-auto"},ut=["disabled"],Vt=L({__name:"BookingView",setup(C){const b=Y(),x=ee(),l=re(),{roomDetail:n,roomLayout:$}=y(l),k=l.getFrontRoom,r=B(),a=r.getStorageData,f=r.createOrder,{peopleNum:g,bookingDate:_,isLoading:v,userInfo:c,selectDistrict:j,addressDetail:d}=y(r),s=A(()=>c.value.name&&c.value.phone&&c.value.email&&j.value&&d.value),o=G(),{isChecked:z}=y(o),H=o.checkUser,M=()=>{z.value?k():(b.push("/login"),oe.fire({title:"訂房前請先登入會員"}))},J=async()=>{await H(),M()};return K(z,()=>{M()}),te(()=>{J(),a()}),(pt,I)=>{const O=D("font-awesome-icon"),R=D("router-link");return u(),m(N,null,[t(n)?(u(),m("main",Le,[e("div",Be,[e("div",je,[e("div",ze,[i(R,{to:`/room/${t(x).params.id}`,class:"text-6 lg:text-8 flex items-center"},{default:U(()=>[i(O,{icon:"fa-solid fa-chevron-left",class:"text-6 lg:text-8 me-2"}),w("確認訂房資訊 ")]),_:1},8,["to"]),e("div",null,[Me,e("div",Ie,[e("div",null,[Oe,e("p",null,p(t(n).name),1)]),e("div",qe,[e("div",null,[Pe,e("p",Ze,"入住："+p(t(h).getTradDateFormat(new Date(t(_).start))),1),e("p",null,"退房："+p(t(h).getTradDateFormat(new Date(t(_).end))),1)]),i(R,{to:`/room/${t(x).params.id}`,class:"underline ms-auto hover:text-primary-100"},{default:U(()=>[w("編輯")]),_:1},8,["to"])]),e("div",Ke,[e("div",null,[Ge,e("p",null,p(t(g))+"人",1)]),i(R,{to:`/room/${t(x).params.id}`,class:"underline ms-auto hover:text-primary-100"},{default:U(()=>[w("編輯")]),_:1},8,["to"])])])]),e("div",He,[i(Ue)]),e("div",null,[Je,e("div",Qe,[i(le,{info:t(n),layout:t($)},null,8,["info","layout"])])])]),e("div",We,[e("div",Xe,[e("div",Ye,[e("div",et,[e("img",{src:t(n).imageUrl,class:"rounded-2 w-full h-[180px] lg:h-[272px] object-cover",alt:t(n).name},null,8,tt),e("div",st,[ot,e("div",lt,[e("div",at,[e("p",null,[w("NT$ "+p(t(h).toThousands(t(n).price))+" ",1),i(O,{icon:"fa-solid fa-xmark"}),w(" "+p(t(h).getNightNum(t(_).start,t(_).end))+" 晚",1)]),e("p",nt,"NT$ "+p(t(h).toThousands(t(n).price*t(h).getNightNum(t(_).start,t(_).end))),1)]),rt,e("div",it,[dt,e("p",ct," NT$ "+p(t(h).toThousands(t(n).price)),1)])])]),e("button",{type:"button",class:"p-4 text-bold rounded-2 bg-primary-100 text-white disabled:bg-neutral-40 disabled:text-neutral-60",disabled:!s.value,onClick:I[0]||(I[0]=mt=>t(f)())},"確認訂房",8,ut)])])])])])])])):E("",!0),t(v)?(u(),se(Ee,{key:1})):E("",!0)],64)}}});export{Vt as default};
