import{d as O,s as k,v as U,r as J,w as I,c,e as m,j as t,f as e,C as j,K as A,F as y,m as M,A as q,k as F,t as d,b as V,g as o,h as N,n as w,L as Q,l as W,o as X,i as v,p as Y,B as Z,u as ee}from"./index-wIY0i8YO.js";import{A as te}from"./swal-MzZ19o4Z.js";import{_ as se}from"./RoomInfoMain.vue_vue_type_script_setup_true_lang-p2SycM-P.js";import{u as T}from"./orderStore-mP__rcc5.js";import{t as $}from"./taiwanCities-y_p8gqPp.js";import{_ as oe}from"./logo-primary-RekCkdNo.js";import{_ as le}from"./_plugin-vue_export-helper-x3n3nnut.js";import{u as ae}from"./roomStore-jor4PSpb.js";import{u as ne}from"./userStore-2EhaLznF.js";import"./RoomInfoBasic.vue_vue_type_script_setup_true_lang-WNVHQJEz.js";import"./RoomInfoProvide.vue_vue_type_script_setup_true_lang-8ADzT-1F.js";const re=e("label",{for:"userAddress"},"地址",-1),ie={key:0,class:"grid grid-cols-2 gap-2"},de={class:"relative"},ce=e("option",{value:"",selected:""},"請選擇縣市",-1),ue=["value"],me=e("div",{class:"absolute top-0 bottom-0 right-0 m-auto p-4"},[e("span",{class:"material-icons"},"keyboard_arrow_down")],-1),pe={class:"relative"},_e=e("option",{value:"",selected:""},"請選擇行政區",-1),fe=["value"],xe=e("div",{class:"absolute top-0 bottom-0 right-0 m-auto p-4"},[e("span",{class:"material-icons"},"keyboard_arrow_down")],-1),he=O({__name:"AddressForm",setup(D){const h=T(),{selectDistrict:u}=k(h),n=U(()=>$?$.map(r=>r.name):[]),l=U(()=>{if($){const r=$.find(a=>a.name===p.value);return r?r.districts:[]}else return[]}),p=J("");return I(p,r=>{r&&(u.value="")}),(r,a)=>(c(),m(y,null,[re,t($)?(c(),m("div",ie,[e("div",de,[j(e("select",{name:"縣市",id:"","onUpdate:modelValue":a[0]||(a[0]=s=>p.value=s),class:"form-input"},[ce,(c(!0),m(y,null,M(n.value,s=>(c(),m("option",{key:s,value:s},d(s),9,ue))),128))],512),[[A,p.value]]),me]),e("div",null,[e("div",pe,[j(e("select",{name:"行政區",id:"","onUpdate:modelValue":a[1]||(a[1]=s=>q(u)?u.value=s:null),class:"form-input"},[_e,(c(!0),m(y,null,M(l.value,s=>(c(),m("option",{key:s.zip,value:s.zip},d(s.name),9,fe))),128))],512),[[A,t(u)]]),xe])])])):F("",!0)],64))}});var ge={VITE_URL:"https://freyja-g4ow.onrender.com",BASE_URL:"/side-project-booking/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const be={class:"flex mb-8 lg:mb-10"},ve=e("h2",{class:"text-5 lg:text-7 text-black"},"訂房人資訊",-1),$e={class:"flex flex-col gap-2"},ke=e("label",{for:"userName"},"姓名",-1),ye={class:"flex flex-col gap-2"},Ve=e("label",{for:"userPhone"},"手機號碼",-1),we={class:"flex flex-col gap-2"},Ne=e("label",{for:"userEmail"},"電子信箱",-1),De={class:"flex flex-col gap-2"},Se=O({__name:"BookingForm",setup(D){const{VITE_URL:h}=ge,u=T(),{userInfo:n,addressDetail:l}=k(u),p=a=>/^(09)[0-9]{8}$/.test(a)?!0:"請輸入正確電話號碼格式，例如 0987654321",r=()=>{const a=`${h}/api/v1/user`;Q.get(a).then(s=>{n.value=s.data.result,l.value=s.data.result.address.detail,console.log("getUser 成功",n.value)}).catch(s=>{console.log("getUser 失敗",s)})};return(a,s)=>{const g=V("VField"),b=V("ErrorMessage"),_=V("VForm");return c(),m(y,null,[e("div",be,[ve,e("button",{class:"btn-text ms-auto underline",onClick:s[0]||(s[0]=f=>r())},"套用會員資料")]),o(_,{class:"flex flex-col gap-4"},{default:N(({errors:f})=>[e("div",$e,[ke,o(g,{type:"text",name:"姓名",class:w([{"border border-red-600":f.姓名},"p-4 rounded-2"]),rules:"required",modelValue:t(n).name,"onUpdate:modelValue":s[1]||(s[1]=i=>t(n).name=i),placeholder:"請輸入姓名"},null,8,["class","modelValue"]),o(b,{class:"text-red-600",name:"姓名"})]),e("div",ye,[Ve,o(g,{type:"tel",name:"手機號碼",class:w([{"border border-red-600":f.手機號碼},"p-4 rounded-2"]),rules:p,modelValue:t(n).phone,"onUpdate:modelValue":s[2]||(s[2]=i=>t(n).phone=i),placeholder:"請輸入手機號碼"},null,8,["class","modelValue"]),o(b,{class:"text-red-600",name:"手機號碼"})]),e("div",we,[Ne,o(g,{type:"email",name:"Email",class:w([{"border border-red-600":f.Email},"p-4 rounded-2"]),rules:"required|email",modelValue:t(n).email,"onUpdate:modelValue":s[3]||(s[3]=i=>t(n).email=i),placeholder:"請輸入有效電子信箱"},null,8,["class","modelValue"]),o(b,{class:"text-red-600",name:"Email"})]),o(he),e("div",De,[o(g,{type:"text",name:"詳細地址",class:w([{"border border-red-600":f.詳細地址},"p-4 rounded-2"]),modelValue:t(l),"onUpdate:modelValue":s[4]||(s[4]=i=>q(l)?l.value=i:null),rules:"required",placeholder:"請輸入詳細地址"},null,8,["class","modelValue"]),o(b,{name:"詳細地址",class:"text-red-600"})])]),_:1})],64)}}}),Ue={},Fe={class:"fixed top-0 left-0 w-full h-full bg-black/40 backdrop-blur-[10px]"},Te=W('<div class="flex justify-center items-center h-full"><div class="w-[765px] h-[600px] bg-white rounded-[20px]"><div class="flex flex-col justify-center items-center h-full"><div class="flex gap-3 mb-[60px]"><span class="block w-[12px] h-[12px] rounded-full bg-neutral-100"></span><span class="block w-[12px] h-[12px] rounded-full bg-neutral-80"></span><span class="block w-[12px] h-[12px] rounded-full bg-neutral-60"></span></div><div class="w-[144px] mb-4"><img class="mb-[5.88px]" src="'+oe+'" alt="享樂飯店 Logo"></div><p class="text-6 font-bold">正在處理你的預定</p></div></div></div>',1),Ce=[Te];function Ee(D,h){return c(),m("div",Fe,Ce)}const Re=le(Ue,[["render",Ee]]),Le={key:0,class:"bg-primary-10"},Be={class:"container mx-auto px-4 xl:px-0 py-10 lg:py-30"},je={class:"flex flex-col lg:flex-row lg:justify-between gap-10 lg:gap-18"},Ae={class:"basis-full lg:basis-7/12 flex flex-col gap-10"},Me=e("h2",{class:"text-5 lg:text-7 text-black mb-8 lg:mb-10"},"訂房資訊",-1),Oe={class:"flex flex-col gap-6 pb-10 lg:pb-[47px] border-b border-neutral-60"},Ie=e("h3",{class:"title-deco ps-4 text-4 mb-2"},"選擇房型",-1),qe={class:"flex items-center"},ze=e("h3",{class:"title-deco ps-4 text-4 mb-2"},"訂房日期",-1),Pe={class:"mb-2"},Ke={class:"flex items-center"},Ge=e("h3",{class:"title-deco ps-4 text-4 mb-2"},"房客人數",-1),He={class:"pb-10 lg:pb-[47px] border-b border-neutral-60"},Je=e("h2",{class:"text-5 lg:text-7 text-black mb-8 lg:mb-10"},"房間資訊",-1),Qe={class:"flex flex-col gap-6"},We={class:"basis-full lg:basis-5/12"},Xe={class:"sticky top-[120px]"},Ye={class:"bg-white p-6 lg:p-10 rounded-[20px]"},Ze={class:"flex flex-col gap-6 lg:gap-10"},et=["src","alt"],tt={class:"flex flex-col gap-6"},st=e("h2",{class:"text-5 lg:text-7"},"價格詳情",-1),ot={class:"flex flex-col gap-4"},lt={class:"flex"},at={class:"ms-auto"},nt={class:"flex pb-4 border-b border-neutral-40"},rt=e("p",null,"住宿折扣",-1),it={class:"ms-auto text-primary-100"},dt={class:"flex font-bold"},ct=e("p",null,"總價",-1),ut={class:"ms-auto"},mt=["disabled"],wt={__name:"BookingView",setup(D){const h=Z(),u=ee(),n=ae(),{roomDetail:l,roomLayout:p}=k(n),r=n.getFrontRoom,a=T(),s=a.getStorageData,g=a.createOrder,{peopleNum:b,bookingDate:_,isLoading:f,userInfo:i,selectDistrict:z,addressDetail:P}=k(a),K=U(()=>i.value.name&&i.value.phone&&i.value.email&&z.value&&P.value),C=ne(),{isChecked:E}=k(C),G=C.checkUser,R=()=>{E.value?r():(h.push("/login"),te.fire({title:"訂房前請先登入會員"}))},H=async()=>{await G(),R()};return I(E,()=>{R()}),X(()=>{H(),s()}),(x,L)=>{const B=V("font-awesome-icon"),S=V("router-link");return c(),m(y,null,[t(l)?(c(),m("main",Le,[e("div",Be,[e("div",je,[e("div",Ae,[o(S,{to:`/room/${t(u).params.id}`,class:"text-6 lg:text-8 flex items-center"},{default:N(()=>[o(B,{icon:"fa-solid fa-chevron-left",class:"text-6 lg:text-8 me-2"}),v("確認訂房資訊 ")]),_:1},8,["to"]),e("div",null,[Me,e("div",Oe,[e("div",null,[Ie,e("p",null,d(t(l).name),1)]),e("div",qe,[e("div",null,[ze,e("p",Pe,"入住："+d(x.$format.getTradDateFormat(t(_).start)),1),e("p",null,"退房："+d(x.$format.getTradDateFormat(t(_).end)),1)]),o(S,{to:`/room/${t(u).params.id}`,class:"underline ms-auto hover:text-primary-100"},{default:N(()=>[v("編輯")]),_:1},8,["to"])]),e("div",Ke,[e("div",null,[Ge,e("p",null,d(t(b))+"人",1)]),o(S,{to:`/room/${t(u).params.id}`,class:"underline ms-auto hover:text-primary-100"},{default:N(()=>[v("編輯")]),_:1},8,["to"])])])]),e("div",He,[o(Se)]),e("div",null,[Je,e("div",Qe,[o(se,{info:t(l),layout:t(p)},null,8,["info","layout"])])])]),e("div",We,[e("div",Xe,[e("div",Ye,[e("div",Ze,[e("img",{src:t(l).imageUrl,class:"rounded-2 w-full h-[180px] lg:h-[272px] object-cover",alt:t(l).name},null,8,et),e("div",tt,[st,e("div",ot,[e("div",lt,[e("p",null,[v("NT$ "+d(x.$format.toThousands(t(l).price))+" ",1),o(B,{icon:"fa-solid fa-xmark"}),v(" "+d(x.$format.getNightNum(t(_).start,t(_).end))+" 晚",1)]),e("p",at,"NT$ "+d(x.$format.toThousands(t(l).price*x.$format.getNightNum(t(_).start,t(_).end))),1)]),e("div",nt,[rt,e("p",it,"NT$ "+d(t(l).discount?"roomDetail.discount":0),1)]),e("div",dt,[ct,e("p",ut," NT$ "+d(x.$format.toThousands(t(l).price)),1)])])]),e("button",{type:"button",class:"p-4 text-bold rounded-2 bg-primary-100 text-white disabled:bg-neutral-40 disabled:text-neutral-60",disabled:!K.value,onClick:L[0]||(L[0]=pt=>t(g)())},"確認訂房",8,mt)])])])])])])])):F("",!0),t(f)?(c(),Y(Re,{key:1})):F("",!0)],64)}}};export{wt as default};
