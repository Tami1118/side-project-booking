import{v as T,u as b,B as x,r as a,x as A,q as v,L as r}from"./index-Hvgb4jPn.js";import{T as I,A as S}from"./swal-MzZ19o4Z.js";var U={VITE_URL:"https://freyja-g4ow.onrender.com",BASE_URL:"/side-project-booking/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_URL:s}=U,B=T("order",()=>{const i=b(),$=x(),k=a(!1),L=a({...{checkInDate:"",checkOutDate:"",peopleNum:0,roomId:"",userInfo:{name:"",phone:"",email:"",address:{zipcode:0,detail:""}}}}),l=a({start:"",end:""}),n=a(2),u=a({name:"",phone:"",email:""}),p=a(""),m=a(""),d=a(!1),_=async()=>{const t={checkInDate:v.getLocalDateFormat(new Date(l.value.start)),checkOutDate:v.getLocalDateFormat(new Date(l.value.end)),peopleNum:n.value,roomId:i.params.id,userInfo:{name:u.value.name,phone:u.value.phone,email:u.value.email,address:{zipcode:parseInt(p.value),detail:m.value}}};try{d.value=!0;const e=`${s}/api/v1/orders/`,o=await r.post(e,t);d.value=!1,O(),$.push(`/booking-complete/${o.data.result._id}`),h(),I.fire({title:"已建立訂單",icon:"success"})}catch{d.value=!1,S.fire({title:"資料有誤，請稍後再試一次",icon:"error"})}},h=()=>{l.value={start:"",end:""},n.value=2,u.value={name:"",phone:"",email:""},p.value="",m.value=""},c=a(null),w=async()=>{try{const t=`${s}/api/v1/orders/${i.params.id}`,e=await r.get(t);c.value=e.data.result}catch{}},y=A(()=>c.value?v.getNightNum(c.value.checkInDate,c.value.checkOutDate)*c.value.roomId.price:0),g=a([]),f=async()=>{try{const t=`${s}/api/v1/orders/`,e=await r.get(t);g.value=e.data.result}catch{}},N=t=>{const e=`${s}/api/v1/orders/${t}`;r.delete(e).then(o=>{console.log(o),f(),I.fire({icon:"success",title:"成功刪除訂單"})}).catch(o=>{console.log(o),S.fire({icon:"error",title:"請重新再試一次"})})},D=()=>{const t=`${s}/api/v1/admin/orders/`;r.get(t).then(e=>{console.log("getOrder 訂單列表",e),g.value=e.data.result}).catch(e=>{console.log(e)})},R=()=>{const t=`${s}/api/v1/admin/orders/${i.params.id}`;r.put(t).then(e=>{console.log(e)}).catch(e=>{console.log(e)})},F=t=>{const e=`${s}/api/v1/admin/orders/${t}`;r.delete(e).then(o=>{console.log("刪除成功",o),D()}).catch(o=>{console.log(o)})},E=()=>{localStorage.setItem("storagePeople",n.value.toString())},P=()=>{const t=localStorage.getItem("storageDate"),e=JSON.parse(t),o=localStorage.getItem("storagePeople");e&&o&&(l.value=e,n.value=Number(o))},O=()=>{localStorage.clear()};return{showOrderModal:k,bookingDate:l,peopleNum:n,userInfo:u,selectDistrict:p,addressDetail:m,tempOrder:L,isLoading:d,createOrder:_,orderList:g,getFrontOrder:w,order:c,getFrontOrders:f,totalPrice:y,deleteFrontOrder:N,resetTempOrder:h,getOrders:D,editOrder:R,deleteOrder:F,setStoragePeople:E,getStorageData:P,cleanStorageData:O}});export{B as u};
