import{d as E,s as $,v as R,r as C,w as K,e as u,f as m,c as s,g as e,B as U,J as O,F as V,m as q,z as P,C as Q,k as B,t as p,b as N,h as n,i as D,n as z,l as W,A as X,u as Y,o as ee,j as y,p as se}from"./index-srPLUe_8.js";import{A as te}from"./userApi-u09h4eQQ.js";import{f as g}from"./format-ue8EY1kP.js";import{_ as oe}from"./RoomInfoMain.vue_vue_type_script_setup_true_lang-cjnGK9v7.js";import{u as Z}from"./orderStore-bZKLuPGe.js";import{t as w}from"./taiwanCities-y_p8gqPp.js";import{u as L}from"./userStore-e7CF8tCK.js";import{_ as le}from"./logo-primary-RekCkdNo.js";import{_ as ae}from"./_plugin-vue_export-helper-x3n3nnut.js";import{u as ne}from"./roomStore-bIpr1pG4.js";import"./RoomInfoBasic.vue_vue_type_script_setup_true_lang-rtQP6Ens.js";import"./RoomInfoProvide.vue_vue_type_script_setup_true_lang-7xhtMJfw.js";const re=e("label",{for:"userAddress"},"地址",-1),ie={key:0,class:"grid grid-cols-2 gap-2"},de={class:"relative"},ce=e("option",{value:"",selected:""},"請選擇縣市",-1),ue=["value"],pe=e("div",{class:"absolute top-0 bottom-0 right-0 m-auto p-4 pointer-events-none"},[e("span",{class:"material-icons"},"keyboard_arrow_down")],-1),me={class:"relative"},_e=e("option",{value:"",selected:""},"請選擇行政區",-1),fe=["value"],ve=e("div",{class:"absolute top-0 bottom-0 right-0 m-auto p-4 pointer-events-none"},[e("span",{class:"material-icons"},"keyboard_arrow_down")],-1),xe={class:"col-span-2"},he=E({__name:"AddressForm",setup(F,{expose:b}){const x=Z(),{selectDistrict:r,addressDetail:a}=$(x),i=R(()=>w.map(d=>d.name)),h=R(()=>{const d=w.find(o=>o.name===t.value);return d?d.districts:[]}),t=C(""),_=C(),v=C(),k=()=>{r.value=(h.value.length>0,"")};K(r,()=>{const d=w.find(o=>o.name===t.value);if(d){const o=d.districts.find(l=>l.name===r.value);o?_.value=Number(o.zip):_.value=NaN}else _.value=NaN});const f=L(),{userInfo:S}=$(f);return b({getAddress:()=>{t.value=S.value.address.zipcode;for(const d of w){const o=d.districts.find(l=>l.zip===t.value.toString());if(o){t.value=d.name,r.value=o.zip,v.value=o.name;break}}a.value=S.value.address.detail.replace(t.value,""),a.value=a.value.replace(v.value,"")}}),(d,o)=>(u(),m(V,null,[re,s(w)?(u(),m("div",ie,[e("div",de,[U(e("select",{name:"縣市",id:"","onUpdate:modelValue":o[0]||(o[0]=l=>t.value=l),class:"form-input",onChange:o[1]||(o[1]=l=>k())},[ce,(u(!0),m(V,null,q(i.value,l=>(u(),m("option",{key:l,value:l},p(l),9,ue))),128))],544),[[O,t.value]]),pe]),e("div",null,[e("div",me,[U(e("select",{name:"行政區",id:"","onUpdate:modelValue":o[2]||(o[2]=l=>P(r)?r.value=l:null),class:"form-input"},[_e,(u(!0),m(V,null,q(h.value,l=>(u(),m("option",{key:l.zip,value:l.zip},p(l.name),9,fe))),128))],512),[[O,s(r)]]),ve])]),e("div",xe,[U(e("input",{type:"text","onUpdate:modelValue":o[3]||(o[3]=l=>P(a)?a.value=l:null),placeholder:"請輸入詳細地址",class:"p-4 rounded-2 w-full"},null,512),[[Q,s(a)]])])])):B("",!0)],64))}}),ge={class:"flex mb-8 lg:mb-10"},be=e("h2",{class:"text-5 lg:text-7 text-black"},"訂房人資訊",-1),$e={class:"flex flex-col gap-2"},ke=e("label",{for:"userName"},"姓名",-1),ye={class:"flex flex-col gap-2"},we=e("label",{for:"userPhone"},"手機號碼",-1),Ve={class:"flex flex-col gap-2"},Ne=e("label",{for:"userEmail"},"電子信箱",-1),Se=E({__name:"BookingForm",setup(F){const b=h=>/^(09)[0-9]{8}$/.test(h)?!0:"請輸入正確電話號碼格式，例如 0987654321",x=L(),{userInfo:r,userInfoTemp:a}=$(x),i=C();return(h,t)=>{const _=N("VField"),v=N("ErrorMessage"),k=N("VForm");return u(),m(V,null,[e("div",ge,[be,e("button",{class:"btn-text ms-auto underline",onClick:t[0]||(t[0]=c=>(s(a).name=s(r).name,s(a).phone=s(r).phone,s(a).email=s(r).email,i.value.getAddress()))},"套用會員資料")]),n(k,{class:"flex flex-col gap-4"},{default:D(({errors:c})=>[e("div",$e,[ke,n(_,{type:"text",name:"姓名",class:z([{"border border-red-600":c.姓名},"p-4 rounded-2"]),rules:"required",modelValue:s(a).name,"onUpdate:modelValue":t[1]||(t[1]=f=>s(a).name=f),placeholder:"請輸入姓名"},null,8,["class","modelValue"]),n(v,{class:"text-red-600",name:"姓名"})]),e("div",ye,[we,n(_,{type:"tel",name:"手機號碼",class:z([{"border border-red-600":c.手機號碼},"p-4 rounded-2"]),rules:b,modelValue:s(a).phone,"onUpdate:modelValue":t[2]||(t[2]=f=>s(a).phone=f),placeholder:"請輸入手機號碼"},null,8,["class","modelValue"]),n(v,{class:"text-red-600",name:"手機號碼"})]),e("div",Ve,[Ne,n(_,{type:"email",name:"Email",class:z([{"border border-red-600":c.Email},"p-4 rounded-2"]),rules:"required|email",modelValue:s(a).email,"onUpdate:modelValue":t[3]||(t[3]=f=>s(a).email=f),placeholder:"請輸入有效電子信箱"},null,8,["class","modelValue"]),n(v,{class:"text-red-600",name:"Email"})]),n(he,{ref_key:"userAddressRef",ref:i},null,512)]),_:1})],64)}}}),Ce={},De={class:"fixed top-0 left-0 w-full h-full bg-black/40 backdrop-blur-[10px]"},Fe=W('<div class="flex justify-center items-center h-full"><div class="w-[765px] h-[600px] bg-white rounded-[20px]"><div class="flex flex-col justify-center items-center h-full"><div class="flex gap-3 mb-[60px]"><span class="block w-[12px] h-[12px] rounded-full bg-neutral-100"></span><span class="block w-[12px] h-[12px] rounded-full bg-neutral-80"></span><span class="block w-[12px] h-[12px] rounded-full bg-neutral-60"></span></div><div class="w-[144px] mb-4"><img class="mb-[5.88px]" src="'+le+'" alt="享樂飯店 Logo"></div><p class="text-6 font-bold">正在處理你的預定</p></div></div></div>',1),Te=[Fe];function Ae(F,b){return u(),m("div",De,Te)}const Ue=ae(Ce,[["render",Ae]]),ze={key:0,class:"bg-primary-10"},Re={class:"container mx-auto px-4 xl:px-0 py-10 lg:py-30"},Be={class:"flex flex-col lg:flex-row lg:justify-between gap-10 lg:gap-18"},Ee={class:"basis-full lg:basis-7/12 flex flex-col gap-10"},Le=e("h2",{class:"text-5 lg:text-7 text-black mb-8 lg:mb-10"},"訂房資訊",-1),je={class:"flex flex-col gap-6 pb-10 lg:pb-[47px] border-b border-neutral-60"},Me=e("h3",{class:"title-deco ps-4 text-4 mb-2"},"選擇房型",-1),Ie={class:"flex items-center"},Oe=e("h3",{class:"title-deco ps-4 text-4 mb-2"},"訂房日期",-1),qe={class:"mb-2"},Pe={class:"flex items-center"},Ze=e("h3",{class:"title-deco ps-4 text-4 mb-2"},"房客人數",-1),Je={class:"pb-10 lg:pb-[47px] border-b border-neutral-60"},Ge=e("h2",{class:"text-5 lg:text-7 text-black mb-8 lg:mb-10"},"房間資訊",-1),He={class:"flex flex-col gap-6"},Ke={class:"basis-full lg:basis-5/12"},Qe={class:"sticky top-[120px]"},We={class:"bg-white p-6 lg:p-10 rounded-[20px]"},Xe={class:"flex flex-col gap-6 lg:gap-10"},Ye=["src","alt"],es={class:"flex flex-col gap-6"},ss=e("h2",{class:"text-5 lg:text-7"},"價格詳情",-1),ts={class:"flex flex-col gap-4"},os={class:"flex"},ls={class:"ms-auto"},as=e("div",{class:"flex pb-4 border-b border-neutral-40"},[e("p",null,"住宿折扣")],-1),ns={class:"flex font-bold"},rs=e("p",null,"總價",-1),is={class:"ms-auto"},ds=["disabled"],ws=E({__name:"BookingView",setup(F){const b=X(),x=Y(),r=ne(),a=r.getFrontRoom,{roomDetail:i,roomLayout:h}=$(r),t=Z(),_=t.getStorageData,v=t.createOrder,{peopleNum:k,bookingDate:c,isLoading:f,selectDistrict:S,addressDetail:j}=$(t),d=R(()=>T.value.name&&T.value.phone&&T.value.email&&S.value&&j.value),o=L(),{isChecked:l,userInfoTemp:T}=$(o),J=o.checkUser,G=()=>{l.value?a():(b.push("/login"),te.fire({title:"訂房前請先登入會員"}))},H=async()=>{await J(),G()};return ee(()=>{H(),_()}),(cs,M)=>{const I=N("font-awesome-icon"),A=N("router-link");return u(),m(V,null,[s(i)?(u(),m("main",ze,[e("div",Re,[e("div",Be,[e("div",Ee,[n(A,{to:`/room/${s(x).params.id}`,class:"text-6 lg:text-8 flex items-center"},{default:D(()=>[n(I,{icon:"fa-solid fa-chevron-left",class:"text-6 lg:text-8 me-2"}),y("確認訂房資訊 ")]),_:1},8,["to"]),e("div",null,[Le,e("div",je,[e("div",null,[Me,e("p",null,p(s(i).name),1)]),e("div",Ie,[e("div",null,[Oe,e("p",qe,"入住："+p(s(g).getTradDateFormat(new Date(s(c).start))),1),e("p",null,"退房："+p(s(g).getTradDateFormat(new Date(s(c).end))),1)]),n(A,{to:`/room/${s(x).params.id}`,class:"underline ms-auto hover:text-primary-100"},{default:D(()=>[y("編輯")]),_:1},8,["to"])]),e("div",Pe,[e("div",null,[Ze,e("p",null,p(s(k))+"人",1)]),n(A,{to:`/room/${s(x).params.id}`,class:"underline ms-auto hover:text-primary-100"},{default:D(()=>[y("編輯")]),_:1},8,["to"])])])]),e("div",Je,[n(Se)]),e("div",null,[Ge,e("div",He,[n(oe,{info:s(i),layout:s(h)},null,8,["info","layout"])])])]),e("div",Ke,[e("div",Qe,[e("div",We,[e("div",Xe,[e("img",{src:s(i).imageUrl,class:"rounded-2 w-full h-[180px] lg:h-[272px] object-cover",alt:s(i).name},null,8,Ye),e("div",es,[ss,e("div",ts,[e("div",os,[e("p",null,[y("NT$ "+p(s(g).toThousands(s(i).price))+" ",1),n(I,{icon:"fa-solid fa-xmark"}),y(" "+p(s(g).getNightNum(s(c).start,s(c).end))+" 晚",1)]),e("p",ls,"NT$ "+p(s(g).toThousands(s(i).price*s(g).getNightNum(s(c).start,s(c).end))),1)]),as,e("div",ns,[rs,e("p",is," NT$ "+p(s(g).toThousands(s(i).price)),1)])])]),e("button",{type:"button",class:"p-4 text-bold rounded-2 bg-primary-100 text-white disabled:bg-neutral-40 disabled:text-neutral-60",disabled:!d.value,onClick:M[0]||(M[0]=us=>s(v)())},"確認訂房",8,ds)])])])])])])])):B("",!0),s(f)?(u(),se(Ue,{key:1})):B("",!0)],64)}}});export{ws as default};
