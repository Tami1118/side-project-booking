import{v as P,u as T,B as x,r,x as A,q as v,L as s}from"./index-IWXpTEn3.js";import{T as S,A as I}from"./swal-MzZ19o4Z.js";var U={VITE_URL:"https://freyja-g4ow.onrender.com",BASE_URL:"/side-project-booking/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_URL:l}=U,M=P("order",()=>{const g=T(),$=x(),F=r(!1),k=r({...{checkInDate:"",checkOutDate:"",peopleNum:0,roomId:"",userInfo:{name:"",phone:"",email:"",address:{zipcode:0,detail:""}}}}),n=r({start:"",end:""}),c=r(2),u=r({name:"",phone:"",email:""}),p=r(""),m=r(""),d=r(!1),L=async()=>{const t={checkInDate:v.getLocalDateFormat(new Date(n.value.start)),checkOutDate:v.getLocalDateFormat(new Date(n.value.end)),peopleNum:c.value,roomId:g.params.id,userInfo:{name:u.value.name,phone:u.value.phone,email:u.value.email,address:{zipcode:parseInt(p.value),detail:m.value}}};try{d.value=!0;const e=`${l}/api/v1/orders/`,o=await s.post(e,t);d.value=!1,console.log("createOrder 新增成功",o),D(),$.push(`/booking-complete/${o.data.result._id}`),h(),S.fire({title:"已建立訂單",icon:"success"})}catch(e){console.log("createOrder 失敗",e),d.value=!1,I.fire({title:"資料有誤，請稍後再試一次",icon:"error"})}},h=()=>{n.value={start:"",end:""},c.value=2,u.value={name:"",phone:"",email:""},p.value="",m.value=""},a=r(null),_=async()=>{try{const t=`${l}/api/v1/orders/${g.params.id}`,e=await s.get(t);a.value=e.data.result,console.log("getFrontOrder 取得資料",a.value)}catch(t){console.log("getFrontOrder 失敗",t)}},w=A(()=>a.value?v.getNightNum(a.value.checkInDate,a.value.checkOutDate)*a.value.roomId.price:0),i=r([]),O=async()=>{try{const t=`${l}/api/v1/orders/`,e=await s.get(t);i.value=e.data.result,console.log("getFrontOrders 取得所有訂單",i.value)}catch(t){console.log("getFrontOrders 失敗",t)}},y=t=>{const e=`${l}/api/v1/orders/${t}`;s.delete(e).then(o=>{console.log(o),O(),S.fire({icon:"success",title:"成功刪除訂單"})}).catch(o=>{console.log(o),I.fire({icon:"error",title:"請重新再試一次"})})},f=()=>{const t=`${l}/api/v1/admin/orders/`;s.get(t).then(e=>{console.log("getOrder 訂單列表",e),i.value=e.data.result}).catch(e=>{console.log(e)})},N=()=>{const t=`${l}/api/v1/admin/orders/${g.params.id}`;s.put(t).then(e=>{console.log(e)}).catch(e=>{console.log(e)})},R=t=>{const e=`${l}/api/v1/admin/orders/${t}`;s.delete(e).then(o=>{console.log("刪除成功",o),f()}).catch(o=>{console.log(o)})},b=()=>{localStorage.setItem("storagePeople",c.value.toString())},E=()=>{const t=localStorage.getItem("storageDate"),e=JSON.parse(t),o=localStorage.getItem("storagePeople");console.log(e,o),e&&o&&(n.value=e,c.value=Number(o)),console.log(n.value,c.value)},D=()=>{localStorage.clear()};return{showOrderModal:F,bookingDate:n,peopleNum:c,userInfo:u,selectDistrict:p,addressDetail:m,tempOrder:k,isLoading:d,createOrder:L,orderList:i,getFrontOrder:_,order:a,getFrontOrders:O,totalPrice:w,deleteFrontOrder:y,resetTempOrder:h,getOrders:f,editOrder:N,deleteOrder:R,setStoragePeople:b,getStorageData:E,cleanStorageData:D,onSubmit:()=>{console.log("123")}}});export{M as u};
