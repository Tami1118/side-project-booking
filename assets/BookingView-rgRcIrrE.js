import{d as B,s as k,v as z,r as C,w as H,e as p,f as _,c as s,g as e,B as A,J as I,F as N,m as O,z as q,C as Q,k as R,t as m,b as S,h as a,i as D,n as T,K as W,l as X,A as Y,u as ee,o as se,j as w,p as te}from"./index-5zW-ksle.js";import{A as oe}from"./userApi--yMtzZvb.js";import{f as g}from"./format-ue8EY1kP.js";import{_ as le}from"./RoomInfoMain.vue_vue_type_script_setup_true_lang-CS83groR.js";import{u as E}from"./orderStore-KyEP6fkm.js";import{t as V}from"./taiwanCities-y_p8gqPp.js";import{u as P}from"./userStore-YZvPMcI4.js";import{_ as ae}from"./logo-primary-RekCkdNo.js";import{_ as ne}from"./_plugin-vue_export-helper-x3n3nnut.js";import{u as re}from"./roomStore-v_49lTzf.js";import"./RoomInfoBasic.vue_vue_type_script_setup_true_lang-Fkl82Fm1.js";import"./RoomInfoProvide.vue_vue_type_script_setup_true_lang-Z0oyZLKt.js";const ie=e("label",{for:"userAddress"},"地址",-1),de={key:0,class:"grid grid-cols-2 gap-2"},ce={class:"relative"},ue=e("option",{value:"",selected:""},"請選擇縣市",-1),pe=["value"],me=e("div",{class:"absolute top-0 bottom-0 right-0 m-auto p-4 pointer-events-none"},[e("span",{class:"material-icons"},"keyboard_arrow_down")],-1),_e={class:"relative"},fe=e("option",{value:"",selected:""},"請選擇行政區",-1),ve=["value"],xe=e("div",{class:"absolute top-0 bottom-0 right-0 m-auto p-4 pointer-events-none"},[e("span",{class:"material-icons"},"keyboard_arrow_down")],-1),he={class:"col-span-2"},ge=B({__name:"AddressForm",setup(F,{expose:b}){const n=E(),{selectDistrict:i,addressDetail:u}=k(n),d=z(()=>V.map(r=>r.name)),x=z(()=>{const r=V.find(o=>o.name===t.value);return r?r.districts:[]}),t=C(""),f=C(),h=C(),y=()=>{i.value=(x.value.length>0,"")};H(i,()=>{const r=V.find(o=>o.name===t.value);if(r){const o=r.districts.find(l=>l.name===i.value);o?f.value=Number(o.zip):f.value=NaN}else f.value=NaN});const v=P(),{userInfo:$}=k(v);return b({getAddress:()=>{t.value=$.value.address.zipcode;for(const r of V){const o=r.districts.find(l=>l.zip===t.value.toString());if(o){t.value=r.name,i.value=o.zip,h.value=o.name;break}}u.value=$.value.address.detail.replace(t.value,""),u.value=u.value.replace(h.value,"")}}),(r,o)=>(p(),_(N,null,[ie,s(V)?(p(),_("div",de,[e("div",ce,[A(e("select",{name:"縣市",id:"","onUpdate:modelValue":o[0]||(o[0]=l=>t.value=l),class:"form-input",onChange:o[1]||(o[1]=l=>y())},[ue,(p(!0),_(N,null,O(d.value,l=>(p(),_("option",{key:l,value:l},m(l),9,pe))),128))],544),[[I,t.value]]),me]),e("div",null,[e("div",_e,[A(e("select",{name:"行政區",id:"","onUpdate:modelValue":o[2]||(o[2]=l=>q(i)?i.value=l:null),class:"form-input"},[fe,(p(!0),_(N,null,O(x.value,l=>(p(),_("option",{key:l.zip,value:l.zip},m(l.name),9,ve))),128))],512),[[I,s(i)]]),xe])]),e("div",he,[A(e("input",{type:"text","onUpdate:modelValue":o[3]||(o[3]=l=>q(u)?u.value=l:null),placeholder:"請輸入詳細地址",class:"p-4 rounded-2 w-full"},null,512),[[Q,s(u)]])])])):R("",!0)],64))}}),be={class:"flex mb-8 lg:mb-10"},$e=e("h2",{class:"text-5 lg:text-7 text-black"},"訂房人資訊",-1),ke={class:"flex flex-col gap-2"},ye=e("label",{for:"userName"},"姓名",-1),we={class:"flex flex-col gap-2"},Ve=e("label",{for:"userPhone"},"手機號碼",-1),Ne={class:"flex flex-col gap-2"},Se=e("label",{for:"userEmail"},"電子信箱",-1),Ce=B({__name:"BookingForm",setup(F){const b=E(),{userInfo:n}=k(b),i=x=>/^(09)[0-9]{8}$/.test(x)?!0:"請輸入正確電話號碼格式，例如 0987654321",u=C(),d=()=>{W.get("/user").then(t=>{n.value=t.data.result,u.value.getAddress(),console.log("getUser 成功",n.value)}).catch(t=>{console.log("getUser 失敗",t)})};return(x,t)=>{const f=S("VField"),h=S("ErrorMessage"),y=S("VForm");return p(),_(N,null,[e("div",be,[$e,e("button",{class:"btn-text ms-auto underline",onClick:t[0]||(t[0]=c=>d())},"套用會員資料")]),a(y,{class:"flex flex-col gap-4"},{default:D(({errors:c})=>[e("div",ke,[ye,a(f,{type:"text",name:"姓名",class:T([{"border border-red-600":c.姓名},"p-4 rounded-2"]),rules:"required",modelValue:s(n).name,"onUpdate:modelValue":t[1]||(t[1]=v=>s(n).name=v),placeholder:"請輸入姓名"},null,8,["class","modelValue"]),a(h,{class:"text-red-600",name:"姓名"})]),e("div",we,[Ve,a(f,{type:"tel",name:"手機號碼",class:T([{"border border-red-600":c.手機號碼},"p-4 rounded-2"]),rules:i,modelValue:s(n).phone,"onUpdate:modelValue":t[2]||(t[2]=v=>s(n).phone=v),placeholder:"請輸入手機號碼"},null,8,["class","modelValue"]),a(h,{class:"text-red-600",name:"手機號碼"})]),e("div",Ne,[Se,a(f,{type:"email",name:"Email",class:T([{"border border-red-600":c.Email},"p-4 rounded-2"]),rules:"required|email",modelValue:s(n).email,"onUpdate:modelValue":t[3]||(t[3]=v=>s(n).email=v),placeholder:"請輸入有效電子信箱"},null,8,["class","modelValue"]),a(h,{class:"text-red-600",name:"Email"})]),a(ge,{ref_key:"userAddressRef",ref:u},null,512)]),_:1})],64)}}}),De={},Fe={class:"fixed top-0 left-0 w-full h-full bg-black/40 backdrop-blur-[10px]"},Ue=X('<div class="flex justify-center items-center h-full"><div class="w-[765px] h-[600px] bg-white rounded-[20px]"><div class="flex flex-col justify-center items-center h-full"><div class="flex gap-3 mb-[60px]"><span class="block w-[12px] h-[12px] rounded-full bg-neutral-100"></span><span class="block w-[12px] h-[12px] rounded-full bg-neutral-80"></span><span class="block w-[12px] h-[12px] rounded-full bg-neutral-60"></span></div><div class="w-[144px] mb-4"><img class="mb-[5.88px]" src="'+ae+'" alt="享樂飯店 Logo"></div><p class="text-6 font-bold">正在處理你的預定</p></div></div></div>',1),Ae=[Ue];function Te(F,b){return p(),_("div",Fe,Ae)}const ze=ne(De,[["render",Te]]),Re={key:0,class:"bg-primary-10"},Be={class:"container mx-auto px-4 xl:px-0 py-10 lg:py-30"},Ee={class:"flex flex-col lg:flex-row lg:justify-between gap-10 lg:gap-18"},Le={class:"basis-full lg:basis-7/12 flex flex-col gap-10"},je=e("h2",{class:"text-5 lg:text-7 text-black mb-8 lg:mb-10"},"訂房資訊",-1),Me={class:"flex flex-col gap-6 pb-10 lg:pb-[47px] border-b border-neutral-60"},Ie=e("h3",{class:"title-deco ps-4 text-4 mb-2"},"選擇房型",-1),Oe={class:"flex items-center"},qe=e("h3",{class:"title-deco ps-4 text-4 mb-2"},"訂房日期",-1),Pe={class:"mb-2"},Ze={class:"flex items-center"},Je=e("h3",{class:"title-deco ps-4 text-4 mb-2"},"房客人數",-1),Ke={class:"pb-10 lg:pb-[47px] border-b border-neutral-60"},Ge=e("h2",{class:"text-5 lg:text-7 text-black mb-8 lg:mb-10"},"房間資訊",-1),He={class:"flex flex-col gap-6"},Qe={class:"basis-full lg:basis-5/12"},We={class:"sticky top-[120px]"},Xe={class:"bg-white p-6 lg:p-10 rounded-[20px]"},Ye={class:"flex flex-col gap-6 lg:gap-10"},es=["src","alt"],ss={class:"flex flex-col gap-6"},ts=e("h2",{class:"text-5 lg:text-7"},"價格詳情",-1),os={class:"flex flex-col gap-4"},ls={class:"flex"},as={class:"ms-auto"},ns=e("div",{class:"flex pb-4 border-b border-neutral-40"},[e("p",null,"住宿折扣")],-1),rs={class:"flex font-bold"},is=e("p",null,"總價",-1),ds={class:"ms-auto"},cs=["disabled"],Vs=B({__name:"BookingView",setup(F){const b=Y(),n=ee(),i=re(),u=i.getFrontRoom,{roomDetail:d,roomLayout:x}=k(i),t=E(),f=t.getStorageData,h=t.createOrder,{peopleNum:y,bookingDate:c,isLoading:v,userInfo:$,selectDistrict:L,addressDetail:r}=k(t),o=z(()=>$.value.name&&$.value.phone&&$.value.email&&L.value&&r.value),l=P(),{isChecked:Z}=k(l),J=l.checkUser,K=()=>{Z.value?u():(b.push("/login"),oe.fire({title:"訂房前請先登入會員"}))},G=async()=>{await J(),K()};return se(()=>{G(),f()}),(us,j)=>{const M=S("font-awesome-icon"),U=S("router-link");return p(),_(N,null,[s(d)?(p(),_("main",Re,[e("div",Be,[e("div",Ee,[e("div",Le,[a(U,{to:`/room/${s(n).params.id}`,class:"text-6 lg:text-8 flex items-center"},{default:D(()=>[a(M,{icon:"fa-solid fa-chevron-left",class:"text-6 lg:text-8 me-2"}),w("確認訂房資訊 ")]),_:1},8,["to"]),e("div",null,[je,e("div",Me,[e("div",null,[Ie,e("p",null,m(s(d).name),1)]),e("div",Oe,[e("div",null,[qe,e("p",Pe,"入住："+m(s(g).getTradDateFormat(new Date(s(c).start))),1),e("p",null,"退房："+m(s(g).getTradDateFormat(new Date(s(c).end))),1)]),a(U,{to:`/room/${s(n).params.id}`,class:"underline ms-auto hover:text-primary-100"},{default:D(()=>[w("編輯")]),_:1},8,["to"])]),e("div",Ze,[e("div",null,[Je,e("p",null,m(s(y))+"人",1)]),a(U,{to:`/room/${s(n).params.id}`,class:"underline ms-auto hover:text-primary-100"},{default:D(()=>[w("編輯")]),_:1},8,["to"])])])]),e("div",Ke,[a(Ce)]),e("div",null,[Ge,e("div",He,[a(le,{info:s(d),layout:s(x)},null,8,["info","layout"])])])]),e("div",Qe,[e("div",We,[e("div",Xe,[e("div",Ye,[e("img",{src:s(d).imageUrl,class:"rounded-2 w-full h-[180px] lg:h-[272px] object-cover",alt:s(d).name},null,8,es),e("div",ss,[ts,e("div",os,[e("div",ls,[e("p",null,[w("NT$ "+m(s(g).toThousands(s(d).price))+" ",1),a(M,{icon:"fa-solid fa-xmark"}),w(" "+m(s(g).getNightNum(s(c).start,s(c).end))+" 晚",1)]),e("p",as,"NT$ "+m(s(g).toThousands(s(d).price*s(g).getNightNum(s(c).start,s(c).end))),1)]),ns,e("div",rs,[is,e("p",ds," NT$ "+m(s(g).toThousands(s(d).price)),1)])])]),e("button",{type:"button",class:"p-4 text-bold rounded-2 bg-primary-100 text-white disabled:bg-neutral-40 disabled:text-neutral-60",disabled:!o.value,onClick:j[0]||(j[0]=ps=>s(h)())},"確認訂房",8,cs)])])])])])])])):R("",!0),s(v)?(p(),te(ze,{key:1})):R("",!0)],64)}}});export{Vs as default};
