import{d as I,s as y,A as B,b as M,c as l,e as n,f as e,t as r,j as o,g,k as p,F as j,m as H,i as F,n as z,v as T,r as C,w as S,o as A,h as E}from"./index-6y3oVoyK.js";import{_ as P}from"./UserBanner.vue_vue_type_style_index_0_lang-L9NhEkrS.js";import{f as u}from"./format-ue8EY1kP.js";import{_ as N}from"./RoomInfoProvide.vue_vue_type_script_setup_true_lang-fpVJX6B0.js";import{u as W}from"./modalStore-W0bkoILg.js";import{u as L}from"./orderStore-Y2wYpqj9.js";import{u as q}from"./userStore-bGPss8dm.js";import"./swal-dnbtQsbR.js";const G={key:0,class:"flex flex-col gap-6 lg:gap-10"},J={class:"text-neutral-60 mb-2 text-3h lg:text-4"},K={key:0,class:"text-4 lg:text-6"},Q={key:1,class:"text-4 lg:text-6"},X=["src","alt"],Y={class:"flex flex-col gap-6 text-3h lg:text-4 text-neutral-80 font-bold pb-6 border-b border-neutral-40"},Z={class:"flex gap-4 lg:text-5"},ee={class:"pe-4 border-r border-neutral-60"},te={class:"title-deco ps-4 mb-2"},se={class:"title-deco ps-4"},oe=e("h3",{class:"title-deco text-3h lg:text-4 ps-4 mb-6 text-neutral"},"房內設備",-1),le=e("h3",{class:"title-deco text-3h lg:text-4 ps-4 mb-6 text-neutral"},"備品提供",-1),ne={class:"flex gap-3"},re={key:1,class:"fixed top-0 left-0 bg-black/40 backdrop-blur-sm w-full h-full z-10 flex justify-center items-center"},ae={class:"bg-white rounded-2 relative"},ce=e("p",{class:"px-[164px] py-[100px] text-5 font-bold"}," 確定要取消此房型的預約嗎？ ",-1),ie={class:"p-3 flex gap-4 border-t border-neutral-40"},de=I({__name:"OrderRoomDetail",props:["order"],setup(t){const m=W(),{isModalOpen:h}=y(m),_=m.openModal,f=m.closeModal,v=L().deleteFrontOrder,s=B();return(x,c)=>{const D=M("font-awesome-icon");return l(),n(j,null,[t.order?(l(),n("div",G,[e("div",null,[e("p",J,"預定參考編號："+r(t.order._id),1),t.order.status===0?(l(),n("h2",K,r(new Date(t.order.checkInDate)>new Date?"即將來的行程":"已結束行程"),1)):(l(),n("h2",Q,"已取消的行程"))]),e("img",{class:"h-[200px] w-full rounded-5 object-cover",src:t.order.roomId.imageUrl,alt:t.order.roomId.name},null,8,X),e("div",Y,[e("div",Z,[e("p",ee,r(t.order.roomId.name)+"，"+r(o(u).getNightNum(t.order.checkInDate,t.order.checkOutDate))+" 晚",1),e("p",null,"住宿人數："+r(t.order.peopleNum)+" 位",1)]),e("div",null,[e("div",te,"入住："+r(o(u).getTradDateSecondary(t.order.checkInDate))+"，15:00 可入住",1),e("div",se,"退房："+r(o(u).getTradDateSecondary(t.order.checkOutDate))+"，12:00 前退房",1)]),e("div",null,"NT$ "+r(o(u).toThousands(t.order.roomId.price)),1)]),e("div",null,[oe,g(N,{info:t.order.roomId.amenityInfo},null,8,["info"])]),e("div",null,[le,g(N,{info:t.order.roomId.facilityInfo},null,8,["info"])]),e("div",ne,[new Date(t.order.checkInDate)>new Date&&t.order.status===0?(l(),n("button",{key:0,class:"grow btn btn-secondary",onClick:c[0]||(c[0]=b=>o(_)())},"取消訂單")):p("",!0),e("button",{class:"grow btn btn-primary",onClick:c[1]||(c[1]=b=>o(s).push(`/room/${t.order.roomId._id}`))},"查看詳情")])])):p("",!0),o(h)?(l(),n("div",re,[e("div",ae,[g(D,{onClick:c[2]||(c[2]=b=>o(f)()),icon:"fa-solid fa-xmark",class:"absolute top-0 right-0 text-4 m-[18px] cursor-pointer"}),ce,e("div",ie,[e("button",{class:"btn btn-secondary w-full",onClick:c[3]||(c[3]=b=>o(f)())},"關閉視窗"),e("button",{class:"btn btn-primary w-full",onClick:c[4]||(c[4]=b=>(o(v)(t.order._id),o(f)()))},"確定取消")])])])):p("",!0)],64)}}}),ue={class:"flex flex-col"},me=["onClick"],he={class:"flex gap-6 flex-col lg:flex-row pb-4 lg:pb-10 border-b border-neutral-40"},fe=["src"],xe={class:"flex flex-col gap-4 text-3h lg:text-4 grow"},ge={class:"text-4 lg:text-6 font-bold"},pe={key:0,class:"font-bold"},_e={class:"mb-2"},be={class:"title-deco ps-4 mb-2"},ve={class:"title-deco ps-4"},ke={class:"font-bold"},we=I({__name:"OrderRoomHistory",props:["orderList"],emits:["detail-selected"],setup(t,{emit:m}){const h=m,_=a=>{h("detail-selected",a)},f=()=>{let a;window.innerWidth<=1024?a=.45*window.innerHeight:a=.55*window.innerHeight,window.scrollTo({top:a,behavior:"smooth"})};return(a,v)=>(l(),n("ul",ue,[(l(!0),n(j,null,H(t.orderList,s=>(l(),n("li",{key:`${s._id}${s.status}`},[e("div",{onClick:x=>(_(s),f()),class:z(["px-4 lg:px-10 pt-4 lg:pt-10 hover:bg-neutral-40 cursor-pointer",new Date(s.checkInDate)<=new Date||s.status===-1?"text-neutral-60":""])},[e("div",he,[e("img",{class:"h-[80px] w-[120px] object-cover object-center rounded-2",src:s.roomId.imageUrl,alt:""},null,8,fe),e("div",xe,[e("p",null,"預定參考編號："+r(s._id),1),e("h3",ge,[F(r(s.roomId.name)+" ",1),s.status===-1?(l(),n("span",pe,"(已取消)")):p("",!0)]),e("div",null,[e("p",_e,"住宿天數："+r(o(u).getNightNum(s.checkInDate,s.checkOutDate))+"晚",1),e("p",null,"住宿人數："+r(s.peopleNum)+"位",1)]),e("div",null,[e("p",be,"入住："+r(o(u).getTradDateSecondary(s.checkInDate)),1),e("p",ve,"退房："+r(o(u).getTradDateSecondary(s.checkOutDate)),1)]),e("p",ke,"NT$ "+r(o(u).toThousands(s.roomId.price*o(u).getNightNum(s.checkInDate,s.checkOutDate))),1)])])],10,me)]))),128))]))}}),De={class:"bg-neutral"},$e={class:"container mx-auto px-4 sm:px-0 pb-10 lg:pb-20"},ye={class:"flex flex-col lg:flex-row gap-10"},Ie={class:"basis-full lg:basis-7/12 bg-white rounded-[20px] p-4 lg:p-10 flex flex-col gap-6 lg:gap-10 h-fit duration-300"},Oe={key:0},Te={key:1,class:"flex flex-col justify-center items-center pb-12"},Ce=e("h2",{class:"mb-6 lg:mb-10 text-4 lg:text-6 me-auto"},"行程詳細內容",-1),Se=e("p",{class:"text-primary-100 lg:text-6 font-bold mb-6"},"尚未有任何訂單",-1),Ne={class:"basis-full lg:basis-5/12 bg-white rounded-[20px] flex flex-col h-fit duration-300"},Me=e("h2",{class:"text-4 lg:text-5 px-4 lg:px-10 pt-4 lg:pt-10 pb-6 lg:pb-10"},"歷史訂單",-1),je={key:0},Fe={class:"p-4 lg:p-10"},Le={key:1,class:"flex flex-col justify-center items-center py-12"},Ve=e("p",{class:"text-primary-100 lg:text-6 font-bold"},"尚未有歷史記錄",-1),Re=[Ve],Ge=I({__name:"UserOrders",setup(t){const m=L(),{orderList:h}=y(m),_=m.getFrontOrders,f=T(()=>{const d=h.value.filter(i=>i.status===0),k=h.value.filter(i=>i.status===-1),w=new Date,O=d.filter(i=>new Date(i.checkInDate)>w),V=d.filter(i=>new Date(i.checkInDate)<=w),R=O.sort((i,$)=>new Date(i.checkInDate).getTime()-new Date($.checkInDate).getTime()),U=V.sort((i,$)=>new Date($.checkInDate).getTime()-new Date(i.checkInDate).getTime());return[...R,...U,...k]}),a=C(),v=d=>{a.value=d},s=C(3),x=T(()=>f.value.slice(0,s.value)),c=()=>{s.value+=3};S(x,d=>{d&&(a.value=x.value[0])});const D=q(),{isChecked:b}=y(D);return S(b,d=>{d&&_()}),A(async()=>{await _(),x.value.length>0&&(a.value=x.value[0])}),(d,k)=>{const w=M("router-link");return l(),n("div",De,[g(P),e("div",$e,[e("div",ye,[e("div",Ie,[a.value?(l(),n("div",Oe,[g(de,{order:a.value},null,8,["order"])])):(l(),n("div",Te,[Ce,Se,g(w,{to:"/room",class:"btn btn-primary"},{default:E(()=>[F("訂房去")]),_:1})]))]),e("div",Ne,[Me,o(h)?(l(),n("div",je,[g(we,{"order-list":x.value,onDetailSelected:v},null,8,["order-list"]),e("div",Fe,[x.value.length<f.value.length?(l(),n("button",{key:0,class:"btn btn-secondary w-full",onClick:k[0]||(k[0]=O=>c())},"查看更多")):p("",!0)])])):p("",!0),o(h)?p("",!0):(l(),n("div",Le,Re))])])])])}}});export{Ge as default};
