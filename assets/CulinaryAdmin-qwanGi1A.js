import{q as B,r as w,K as $,s as D,b as j,e as f,f as _,g as e,t as F,c as t,h as u,i as I,n as T,k as S,d as A,j as y,N as L,o as z,F as R,m as K,p as q}from"./index-D7joAqCD.js";import{T as N,A as O}from"./swal-jtAPSmEf.js";import{u as P}from"./userStore-B-xb6qbS.js";var G={VITE_URL:"https://freyja-g4ow.onrender.com",BASE_URL:"/side-project-booking/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_URL:k}=G,U=B("foodStore",()=>{const V={title:"",description:"",image:"",diningTime:""},a=w(JSON.parse(JSON.stringify(V))),r=()=>{a.value=JSON.parse(JSON.stringify(V))},s=w(null),m=async()=>{try{console.log("getFood");const d=`${k}/api/v1/admin/culinary/`,o=await $.get(d);s.value=o.data.result,console.log("getFoods 已取得",o)}catch(d){console.log("getFoods 取得失敗",d)}},x=()=>{const d=`${k}/api/v1/admin/culinary/`;$.post(d,a.value).then(o=>{console.log(o),N.fire({icon:"success",title:`已新增 ${o.data.result.title}`}),m()}).catch(o=>{console.log(o),O.fire({icon:"error",title:"新增失敗，請稍後再試一次"})})},l=w(""),h=w(""),n=()=>{const d=`${k}/api/v1/admin/culinary/${h.value}`;$.put(d,a.value).then(o=>{console.log("editFood 已更新",o),N.fire({icon:"success",title:`${o.data.result.title} 已更新`}),m()}).catch(o=>{console.log("editFood 更新失敗",o),O.fire({icon:"error",title:"更新失敗，請稍後再試一次"})})},g=()=>{const d=`${k}/api/v1/admin/culinary/${h.value}`;$.delete(d).then(o=>{console.log("deleteFood 已刪除",o),N.fire({icon:"success",title:`已刪除 ${o.data.result.title}`}),m()}).catch(o=>{console.log("deleteFood 刪除失敗",o),O.fire({icon:"error",title:"刪除失敗，請稍後再試一次"})})},v=()=>{const d=`${k}/api/v1/home/culinary/`;$.get(d).then(o=>{console.log("getFrontFoods 已取得美食",o),s.value=o.data.result}).catch(o=>{console.log("getFrontFoods 失敗",o)})},M=async()=>{try{const d=`${k}/api/v1/culinary/`,o=await $.get(d);a.value=o.data.result,console.log("getFrontFood 已取得單一美食",o)}catch(d){console.log(d)}},i=w(!1),p=()=>{i.value=!0},E=()=>{i.value=!1,r()},C=()=>{i.value=!i.value},b=w(!1);return{tempFood:a,resetTempFood:r,foodList:s,getFoods:m,createFood:x,updateFoodType:l,editFoodId:h,editFood:n,deleteFood:g,getFrontFoods:v,getFrontFood:M,showFoodModal:i,openFoodModal:p,closeFoodModal:E,toogleModal:C,showDelModal:b,openFoodDelModal:()=>{b.value=!0},closeFoodDelModal:()=>{b.value=!1,r()}}}),H={class:"fixed top-0 left-0 w-full h-full bg-neutral-100/50 backdrop-blur-sm flex justify-center items-center"},Q={"data-aos":"fade-up","data-aos-delay":"50","data-aos-duration":"300",class:"bg-white w-full md:w-2/3 xl:w-1/3 h-full md:h-fit md:max-h-[80vh] xl:max-h-[70vh] md:rounded-4 overflow-scroll duration-500 ease-in"},W={class:"sticky top-0 px-5 py-4 z-10 border-b border-primary flex justify-between bg-primary-40 text-primary"},X={class:"text-5"},Y={class:"p-4 flex flex-col gap-4"},Z=e("label",{for:"food-title",class:"font-bold"},"名稱",-1),ee=e("label",{for:"food-diningTime",class:"font-bold"},"供應時間",-1),te=e("label",{for:"food-description",class:"font-bold"},"內容",-1),oe=e("label",{for:"food-image",class:"font-bold"},"圖片",-1),se=["src"],le={class:"bg-white sticky bottom-0 z-10 border-t border-primary-60 p-4 flex gap-2 justify-end"},ne={type:"submit",class:"btn btn-primary"},ae={__name:"FoodModal",setup(V){const a=U(),{updateFoodType:r,tempFood:s}=D(a),m=a.createFood,x=a.editFood,l=a.closeFoodModal;return(h,n)=>{const g=j("VField"),v=j("ErrorMessage"),M=j("VForm");return f(),_("div",H,[e("div",Q,[e("div",W,[e("h1",X,F(t(r)==="create"?"新增":"編輯")+"美饌",1),e("span",{class:"material-icons cursor-pointer",onClick:n[0]||(n[0]=i=>t(l)())},"close")]),u(M,{class:"flex flex-col",onSubmit:n[6]||(n[6]=i=>(t(r)==="create"?t(m)():t(x)(),t(l)()))},{default:I(({errors:i})=>[e("div",Y,[e("div",null,[Z,u(g,{type:"text",id:"food-title",name:"名稱",class:T([{"is-invalid":i.名稱},"form-input"]),rules:"required",modelValue:t(s).title,"onUpdate:modelValue":n[1]||(n[1]=p=>t(s).title=p),placeholder:"請輸入名稱"},null,8,["class","modelValue"]),u(v,{name:"名稱",class:"text-alert-100 text-3h"})]),e("div",null,[ee,u(g,{type:"text",id:"food-diningTime",name:"供應時間",class:T([{"is-invalid":i.供應時間},"form-input"]),rules:"required",modelValue:t(s).diningTime,"onUpdate:modelValue":n[2]||(n[2]=p=>t(s).diningTime=p),placeholder:"請輸入供應時間"},null,8,["class","modelValue"]),u(v,{name:"供應時間",class:"text-alert-100 text-3h"})]),e("div",null,[te,u(g,{as:"textarea",id:"food-description",name:"內容",class:T([{"is-invalid":i.內容},"form-input"]),rules:"required",modelValue:t(s).description,"onUpdate:modelValue":n[3]||(n[3]=p=>t(s).description=p),placeholder:"請輸入內容"},null,8,["class","modelValue"]),u(v,{name:"內容",class:"text-alert-100 text-3h"})]),e("div",null,[oe,u(g,{type:"text",id:"food-image",name:"圖片",class:T([{"is-invalid":i.圖片},"form-input"]),rules:"required",modelValue:t(s).image,"onUpdate:modelValue":n[4]||(n[4]=p=>t(s).image=p),placeholder:"請輸入圖片連結"},null,8,["class","modelValue"]),u(v,{name:"圖片",class:"text-alert-100 text-3h"}),t(s).image?(f(),_("img",{key:0,src:t(s).image,class:"mt-2 rounded-2 h-[200px] w-full object-cover",alt:""},null,8,se)):S("",!0)])]),e("div",le,[e("button",{type:"button",class:"btn btn-secondary",onClick:n[5]||(n[5]=p=>t(l)())},"取消"),e("button",ne,"確認"+F(t(r)==="create"?"新增":"更新"),1)])]),_:1})])])}}},de={class:"w-full h-[30vh] lg:h-[24vh] flex justify-center items-center px-6"},re={class:"text-5 font-bold text-justify"},ie={class:"text-primary-100"},ce={class:"p-3 flex gap-4 border-t border-primary-60"},ue=A({__name:"FoodDelete",setup(V){const a=U(),{tempFood:r}=D(a),s=a.closeFoodDelModal,m=a.deleteFood;return(x,l)=>(f(),_("div",{onClick:l[3]||(l[3]=L(h=>t(s)(),["stop"])),class:"fixed top-0 left-0 w-full h-full bg-black/40 backdrop-blur-sm flex justify-center items-end lg:items-center"},[e("div",{onClick:l[2]||(l[2]=L(()=>{},["stop"])),class:"bg-white rounded-t-[16px] lg:rounded-[16px] w-full lg:w-[36vw]"},[e("div",de,[e("p",re,[y(" 刪除後無法復原，確定要刪除 "),e("span",ie,F(t(r).title),1),y(" 嗎？ ")])]),e("div",ce,[e("button",{class:"btn btn-secondary w-full",onClick:l[0]||(l[0]=h=>t(s)())},"關閉視窗"),e("button",{class:"btn btn-primary w-full",onClick:l[1]||(l[1]=h=>(t(m)(),t(s)()))},"刪除")])])]))}}),pe={class:"p-10 flex flex-col gap-6"},fe={class:"flex items-end"},me=e("h1",{class:"text-7"},"美饌管理",-1),he={key:0,class:"font-bold ms-2"},_e={class:"text-primary-100"},ge={key:0,class:"text-primary-100 text-7 font-bold w-full h-[70vh] flex justify-center items-center"},ve={key:1,class:"w-full admin-table"},be=e("thead",null,[e("tr",{class:"border-y border-primary-60"},[e("th",{class:"text-start",width:"15%"}),e("th",{class:"text-center",width:"10%"},"名稱"),e("th",{class:"text-center",width:"30%"},"內容"),e("th",{class:"text-center",width:"20%"},"供應時間"),e("th",{class:"text-center",width:"25%"},"管理")])],-1),ye=["src","alt"],xe={class:"text-center"},Fe={class:"text-justify"},we={class:"text-center"},$e={class:"flex flex-wrap justify-center gap-2"},ke=["onClick"],Ve=["onClick"],Te=A({__name:"CulinaryAdmin",setup(V){const a=U(),{foodList:r,tempFood:s,editFoodId:m,updateFoodType:x,showFoodModal:l,showDelModal:h}=D(a),n=a.getFoods,g=P(),{isChecked:v}=D(g),M=g.checkUser,i=()=>{v.value&&n()},p=async()=>{await M(),i()};return z(()=>{p()}),(E,C)=>{const b=j("font-awesome-icon");return f(),_(R,null,[e("div",pe,[e("div",fe,[me,t(r)?(f(),_("p",he,[y("(共 "),e("span",_e,F(t(r).length),1),y(" 筆資料)")])):S("",!0)]),e("button",{class:"btn btn-primary ms-auto",onClick:C[0]||(C[0]=c=>(l.value=!0,x.value="create"))},[u(b,{icon:"fa-solid fa-plus",class:"me-2"}),y(" 新增美饌 ")]),t(r)?(f(),_("table",ve,[be,e("tbody",null,[(f(!0),_(R,null,K(t(r),c=>(f(),_("tr",{key:c._id,class:"border-b border-primary-60 hover:bg-primary-40"},[e("th",null,[c.image?(f(),_("img",{key:0,class:"w-full h-[120px] object-cover rounded-2",src:c.image,alt:c.title},null,8,ye)):S("",!0)]),e("th",xe,F(c.title),1),e("th",Fe,F(c.description),1),e("th",we,F(c.diningTime),1),e("th",null,[e("div",$e,[e("button",{onClick:J=>(l.value=!0,s.value=JSON.parse(JSON.stringify(c)),x.value="edit",m.value=c._id),class:"btn btn-primary text-4h"},[u(b,{icon:"fa-solid fa-pencil",class:"me-2"}),y(" 編輯 ")],8,ke),e("button",{onClick:J=>(h.value=!0,s.value=JSON.parse(JSON.stringify(c)),m.value=c._id),class:"btn text-primary-100 text-4h hover:text-primary border border-primary-100 hover:border-primary bg-transparent hover:bg-primary-60"},[u(b,{icon:"fa-solid fa-trash-can",class:"me-2"}),y(" 刪除 ")],8,Ve)])])]))),128))])])):(f(),_("div",ge,[u(b,{icon:"fa-solid fa-utensils",class:"me-2"}),y(" 目前還沒有任何美食，快去新增吧！ ")]))]),t(l)?(f(),q(ae,{key:0})):S("",!0),t(h)?(f(),q(ue,{key:1})):S("",!0)],64)}}});export{Te as default};
