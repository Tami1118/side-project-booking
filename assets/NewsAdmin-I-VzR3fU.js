import{v as q,r as x,q as y,s as D,b as j,e as u,f as h,g as e,t as k,c as t,h as m,i as I,n as O,k as V,d as B,j as b,N as L,o as z,F as R,m as P,p as A}from"./index-ZqzRWSCL.js";import{T as F,A as T}from"./swal-Imie3hvR.js";import{u as G}from"./userStore-d18P0GkM.js";var H={VITE_URL:"https://freyja-g4ow.onrender.com",BASE_URL:"/side-project-booking/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_URL:$}=H,U=q("newsStore",()=>{const M={title:"",description:"",image:""},n=x(JSON.parse(JSON.stringify(M))),i=()=>{n.value=JSON.parse(JSON.stringify(M))},o=x(null),p=async()=>{try{console.log("getNews");const r=`${$}/api/v1/admin/news/`,s=await y.get(r);o.value=s.data.result,console.log("getNews 已取得",s)}catch(r){console.log("getNews 取得失敗",r)}},g=()=>{const r=`${$}/api/v1/admin/news/`;y.post(r,n.value).then(s=>{console.log(s),F.fire({icon:"success",title:`已新增 ${s.data.result.title}`}),p()}).catch(s=>{console.log(s),T.fire({icon:"error",title:"新增失敗，請稍後再試一次"})})},l=x(""),w=x(""),a=()=>{const r=`${$}/api/v1/admin/news/${w.value}`;y.put(r,n.value).then(s=>{console.log("editNews 已更新",s),F.fire({icon:"success",title:`${s.data.result.title} 已更新`}),p()}).catch(s=>{console.log("editNews 更新失敗",s),T.fire({icon:"error",title:"更新失敗，請稍後再試一次"})})},_=()=>{const r=`${$}/api/v1/admin/news/${w.value}`;y.delete(r).then(s=>{console.log("deleteNews 已刪除",s),F.fire({icon:"success",title:`已刪除 ${s.data.result.title}`}),p()}).catch(s=>{console.log("deleteNews 刪除失敗",s),T.fire({icon:"error",title:"刪除失敗，請稍後再試一次"})})},N=()=>{const r=`${$}/api/v1/home/news/`;y.get(r).then(s=>{console.log("getFrontNews 已取得消息",s),o.value=s.data.result}).catch(s=>{console.log("getFrontNews 失敗",s)})},S=async()=>{try{const r=`${$}/api/v1/news/`,s=await y.get(r);n.value=s.data.result,console.log("getFrontOneNews 已取得單一消息",s)}catch(r){console.log(r)}},c=x(!1),f=()=>{c.value=!0},E=()=>{c.value=!1,i()},C=()=>{c.value=!c.value},v=x(!1);return{tempNews:n,resetTempNews:i,newsList:o,getNews:p,createNews:g,updateNewsType:l,editNewsId:w,editNews:a,deleteNews:_,getFrontNews:N,getFrontOneNews:S,showNewsModal:c,openNewsModal:f,closeNewsModal:E,toogleModal:C,showDelModal:v,openNewsDelModal:()=>{v.value=!0},closeNewsDelModal:()=>{v.value=!1,i()}}}),K={class:"fixed top-0 left-0 w-full h-full bg-neutral-100/50 backdrop-blur-sm flex justify-center items-center"},Q={"data-aos":"fade-up","data-aos-delay":"50","data-aos-duration":"300",class:"bg-white w-full md:w-2/3 xl:w-1/3 h-full md:h-fit md:max-h-[80vh] xl:max-h-[70vh] md:rounded-4 overflow-scroll duration-500 ease-in"},W={class:"sticky top-0 px-5 py-4 z-10 border-b border-primary flex justify-between bg-primary-40 text-primary"},X={class:"text-5"},Y={class:"p-4 flex flex-col gap-4"},Z=e("label",{for:"news-title",class:"font-bold"},"名稱",-1),ee=e("label",{for:"news-description",class:"font-bold"},"內容",-1),te=e("label",{for:"news-image",class:"font-bold"},"圖片",-1),se=["src"],oe={class:"bg-white sticky bottom-0 z-10 border-t border-primary-60 p-4 flex gap-2 justify-end"},le={type:"submit",class:"btn btn-primary"},ne={__name:"NewsModal",setup(M){const n=U(),{updateNewsType:i,tempNews:o}=D(n),p=n.createNews,g=n.editNews,l=n.closeNewsModal;return(w,a)=>{const _=j("VField"),N=j("ErrorMessage"),S=j("VForm");return u(),h("div",K,[e("div",Q,[e("div",W,[e("h1",X,k(t(i)==="create"?"新增":"編輯")+"消息",1),e("span",{class:"material-icons cursor-pointer",onClick:a[0]||(a[0]=c=>t(l)())},"close")]),m(S,{class:"flex flex-col",onSubmit:a[5]||(a[5]=c=>(t(i)==="create"?t(p)():t(g)(),t(l)()))},{default:I(({errors:c})=>[e("div",Y,[e("div",null,[Z,m(_,{type:"text",id:"news-title",name:"名稱",class:O([{"is-invalid":c.名稱},"form-input"]),rules:"required",modelValue:t(o).title,"onUpdate:modelValue":a[1]||(a[1]=f=>t(o).title=f),placeholder:"請輸入名稱"},null,8,["class","modelValue"]),m(N,{name:"名稱",class:"text-alert-100 text-3h"})]),e("div",null,[ee,m(_,{as:"textarea",id:"news-description",name:"內容",class:O([{"is-invalid":c.內容},"form-input"]),rules:"required",modelValue:t(o).description,"onUpdate:modelValue":a[2]||(a[2]=f=>t(o).description=f),placeholder:"請輸入內容"},null,8,["class","modelValue"]),m(N,{name:"內容",class:"text-alert-100 text-3h"})]),e("div",null,[te,m(_,{type:"text",id:"news-image",name:"圖片",class:O([{"is-invalid":c.圖片},"form-input"]),rules:"required",modelValue:t(o).image,"onUpdate:modelValue":a[3]||(a[3]=f=>t(o).image=f),placeholder:"請輸入圖片連結"},null,8,["class","modelValue"]),m(N,{name:"圖片",class:"text-alert-100 text-3h"}),t(o).image?(u(),h("img",{key:0,src:t(o).image,class:"mt-2 rounded-2 h-[200px] w-full object-cover",alt:""},null,8,se)):V("",!0)])]),e("div",oe,[e("button",{type:"button",class:"btn btn-secondary",onClick:a[4]||(a[4]=f=>t(l)())},"取消"),e("button",le,"確認"+k(t(i)==="create"?"新增":"更新"),1)])]),_:1})])])}}},ae={class:"w-full h-[30vh] lg:h-[24vh] flex justify-center items-center px-6"},re={class:"text-5 font-bold text-justify"},ie={class:"text-primary-100"},ce={class:"p-3 flex gap-4 border-t border-primary-60"},de=B({__name:"NewsDelete",setup(M){const n=U(),{tempNews:i}=D(n),o=n.closeNewsDelModal,p=n.deleteNews;return(g,l)=>(u(),h("div",{onClick:l[3]||(l[3]=L(w=>t(o)(),["stop"])),class:"fixed top-0 left-0 w-full h-full bg-black/40 backdrop-blur-sm flex justify-center items-end lg:items-center"},[e("div",{onClick:l[2]||(l[2]=L(()=>{},["stop"])),class:"bg-white rounded-t-[16px] lg:rounded-[16px] w-full lg:w-[36vw]"},[e("div",ae,[e("p",re,[b(" 刪除後無法復原，確定要刪除 "),e("span",ie,k(t(i).title),1),b(" 嗎？ ")])]),e("div",ce,[e("button",{class:"btn btn-secondary w-full",onClick:l[0]||(l[0]=w=>t(o)())},"關閉視窗"),e("button",{class:"btn btn-primary w-full",onClick:l[1]||(l[1]=w=>(t(p)(),t(o)()))},"刪除")])])]))}}),ue={class:"p-10 flex flex-col gap-6"},pe={class:"flex items-end"},me=e("h1",{class:"text-7"},"消息管理",-1),we={key:0,class:"font-bold ms-2"},fe={class:"text-primary-100"},he={key:0,class:"text-primary-100 text-7 font-bold w-full h-[70vh] flex justify-center items-center"},_e={key:1,class:"w-full admin-table"},ve=e("thead",null,[e("tr",{class:"border-y border-primary-60"},[e("th",{class:"text-start",width:"15%"}),e("th",{class:"text-center",width:"20%"},"名稱"),e("th",{class:"text-center",width:"30%"},"內容"),e("th",{class:"text-center",width:"25%"},"管理")])],-1),be=["src","alt"],ge={class:"text-center"},Ne={class:"text-justify"},xe={class:"flex flex-wrap justify-center gap-2"},ye=["onClick"],$e=["onClick"],Ve=B({__name:"NewsAdmin",setup(M){const n=U(),{newsList:i,tempNews:o,editNewsId:p,updateNewsType:g,showNewsModal:l,showDelModal:w}=D(n),a=n.getNews,_=G(),{isChecked:N}=D(_),S=_.checkUser,c=()=>{N.value&&a()},f=async()=>{await S(),c()};return z(()=>{f()}),(E,C)=>{const v=j("font-awesome-icon");return u(),h(R,null,[e("div",ue,[e("div",pe,[me,t(i)?(u(),h("p",we,[b("(共 "),e("span",fe,k(t(i).length),1),b(" 筆資料)")])):V("",!0)]),e("button",{class:"btn btn-primary ms-auto",onClick:C[0]||(C[0]=d=>(l.value=!0,g.value="create"))},[m(v,{icon:"fa-solid fa-plus",class:"me-2"}),b(" 新增消息 ")]),t(i)?(u(),h("table",_e,[ve,e("tbody",null,[(u(!0),h(R,null,P(t(i),d=>(u(),h("tr",{key:d._id,class:"border-b border-primary-60 hover:bg-primary-40"},[e("th",null,[d.image?(u(),h("img",{key:0,class:"w-full h-[120px] object-cover rounded-2",src:d.image,alt:d.title},null,8,be)):V("",!0)]),e("th",ge,k(d.title),1),e("th",Ne,k(d.description),1),e("th",null,[e("div",xe,[e("button",{onClick:J=>(l.value=!0,o.value=JSON.parse(JSON.stringify(d)),g.value="edit",p.value=d._id),class:"btn btn-primary text-4h"},[m(v,{icon:"fa-solid fa-pencil",class:"me-2"}),b(" 編輯 ")],8,ye),e("button",{onClick:J=>(w.value=!0,o.value=JSON.parse(JSON.stringify(d)),p.value=d._id),class:"btn text-primary-100 text-4h hover:text-primary border border-primary-100 hover:border-primary bg-transparent hover:bg-primary-60"},[m(v,{icon:"fa-solid fa-trash-can",class:"me-2"}),b(" 刪除 ")],8,$e)])])]))),128))])])):(u(),h("div",he,[m(v,{icon:"fa-solid fa-bullhorn",class:"me-2"}),b(" 目前還沒有任何消息，快去新增吧！ ")]))]),t(l)?(u(),A(ne,{key:0})):V("",!0),t(w)?(u(),A(de,{key:1})):V("",!0)],64)}}});export{Ve as default};
